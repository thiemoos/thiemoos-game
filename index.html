<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>추리게임</title>
<style>
  #background { width:100%; height:200px; background-color: #ccc; text-align:center; line-height:200px; font-weight:bold; }
  button { padding: 10px; margin: 5px; }
  #locations, #clues, #characters, #investigation { margin-top: 20px; }
  #ending { margin-top: 30px; font-weight: bold; white-space: pre-line; }
</style>
</head>
<body>

<div id="background">배경</div>

<div id="locations">
  <button onclick="goTo('홀')">홀</button>
  <button onclick="goTo('VIP 대기실')">VIP 대기실</button>
  <button onclick="goTo('일반 대기실')">일반 대기실</button>
</div>

<div id="clues"></div>
<div id="characters"></div>

<div id="investigation">
  <button onclick="askQuestion(1)">질문 1</button>
  <button onclick="askQuestion(2)">질문 2</button>
</div>

<button id="arrestBtn" onclick="arrest()">체포</button>
<div id="ending"></div>

<script>
let investigationCount = 0;
let cluesFound = [];
let currentLocation = "홀";

// 캐릭터 및 단서
let characters = [
  {name:"권현조", clue:"만년필", isCriminal:false, answers:[{text:"대기실 들어간 적 없음", isKey:false},{text:"만년필 본 적 없음", isKey:false}], correctCount:0},
  {name:"김무진", clue:"캠코더", isCriminal:false, answers:[{text:"홀에서 촬영 중", isKey:false},{text:"캠코더 계속 들고 다님", isKey:false}], correctCount:0},
  {name:"남두헌", clue:"담배꽁초", isCriminal:true, answers:[{text:"대기실서 담배 피움", isKey:true},{text:"재떨이 담배 맞음", isKey:true}], correctCount:0},
  {name:"병구", clue:"머리빗", isCriminal:false, answers:[{text:"머리빗 떨어트림", isKey:false},{text:"홀에서 본 것 없음", isKey:false}], correctCount:0},
  {name:"사철성", clue:"술병", isCriminal:false, answers:[{text:"술병 테이블 위", isKey:false},{text:"홀에서 술 마심", isKey:false}], correctCount:0},
  {name:"영진호", clue:"피", isCriminal:false, answers:[{text:"홀에서 피 발견", isKey:false},{text:"피는 경호원과 관련", isKey:false}], correctCount:0},
  {name:"이돈", clue:"손수건", isCriminal:false, answers:[{text:"VIP 대기실 손수건", isKey:false},{text:"손수건 준 적 있음", isKey:false}], correctCount:0},
  {name:"이성조", clue:"발자국", isCriminal:false, answers:[{text:"VIP 대기실 발자국 발견", isKey:false},{text:"발자국 관련 없음", isKey:false}], correctCount:0},
  {name:"조태주", clue:"찢어진 종이", isCriminal:false, answers:[{text:"일반 대기실 종이 발견", isKey:false},{text:"종이 관련 없음", isKey:false}], correctCount:0},
  {name:"천은호", clue:"고양이", isCriminal:false, answers:[{text:"일반 대기실 고양이 발견", isKey:false},{text:"고양이 관련 없음", isKey:false}], correctCount:0}
];

// 장소별 단서
let cluesByLocation = {
  "홀": ["술병","피","캠코더"],
  "VIP 대기실": ["머리빗","만년필","손수건","발자국"],
  "일반 대기실": ["담배꽁초","찢어진 종이","고양이"]
};

function goTo(location){
  currentLocation = location;
  document.getElementById("background").innerText = location + "로 이동";
  showClues(location);
}

function showClues(location){
  let clueDiv = document.getElementById("clues");
  clueDiv.innerHTML = "";
  cluesByLocation[location].forEach(clue => {
    if(!cluesFound.includes(clue)){
      let btn = document.createElement("button");
      btn.innerText = clue;
      btn.onclick = () => {
        cluesFound.push(clue);
        alert(clue + "를 찾았습니다.");
        showCharacters();
        btn.disabled = true;
      };
      clueDiv.appendChild(btn);
    }
  });
}

function showCharacters(){
  let charDiv = document.getElementById("characters");
  charDiv.innerHTML = "";
  characters.forEach(char => {
    if(cluesFound.includes(char.clue)){
      let btn = document.createElement("button");
      btn.innerText = char.name;
      btn.onclick = () => alert("선택: " + char.name);
      charDiv.appendChild(btn);
    }
  });
}

function askQuestion(qNum){
  if(investigationCount >= 3){ alert("조사 횟수 초과!"); return; }
  investigationCount++;

  characters.forEach(char => {
    if(cluesFound.includes(char.clue)){
      let answer = char.answers[qNum-1];
      alert(char.name + " 답변: " + answer.text);
      if(answer.isKey) char.correctCount++;
    }
  });
}

function arrest(){
  let selectedName = prompt("체포할 인물 이름을 입력하세요:");
  let criminal = characters.find(c => c.isCriminal);
  let endingDiv = document.getElementById("ending");

  if(selectedName === criminal.name){
    let keyFound = criminal.correctCount;
    let penalty = "";
    if(keyFound <= 1) penalty = "증거 불충분";
    else if(keyFound==2) penalty = "집행유예";
    else if(keyFound==3) penalty = "1년";
    else if(keyFound==4) penalty = "5년";
    else penalty = "10년~무기징역";

    endingDiv.innerText = "정답! 범인은 " + criminal.name +
      "\n핵심 답변 맞춘 개수: " + keyFound +
      "\n형량: " + penalty;
  } else {
    endingDiv.innerText = "오답! 억울한 사람이 옥살이를 하게 됨.";
  }
}
</script>

</body>
</html>